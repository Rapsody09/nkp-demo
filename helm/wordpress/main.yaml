---
apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
  name: demo-wordpress
  labels:
    app: demo-wordpress
    environment: demo
spec:
  interval: 15s
  releaseName: demo-wordpress
  chart:
    spec:
      chart: wordpress
      sourceRef:
        kind: HelmRepository
        name: bitnami-custom
      version: "24.1.18"
  values:
    global:
      imageRegistry: "10.0.114.161:5000/library"
      security:
        allowInsecureImages: true
    
    # Configuration WordPress personnalisée
    wordpressUsername: erwann
    wordpressPassword: erwann
    wordpressBlogName: "Nutanix Kubernetes Platform Demo"
    

      
    # Labels et métadonnées
    podLabels:
      app: demo-wordpress
      version: "24.1.18"
      component: cms
      environment: demo
    
    # Performances optimisées pour démo
    replicaCount: 1
    
    # Base de données MySQL
    mysql:
      primary:
        persistence:
          enabled: true
          size: 8Gi
          storageClass: "nutanix-volume"
        # Pour les StatefulSets, utiliser cette approche
        podAnnotations:
          "helm.sh/resource-policy": ""
        # Ou directement sur le StatefulSet
        statefulsetAnnotations:
          "helm.sh/resource-policy": ""



